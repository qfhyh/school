(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["leave"],{"2a20":function(e,t,a){"use strict";var i=a("6da6"),n=a.n(i);n.a},"2d3e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leave"},[a("van-nav-bar",{attrs:{title:"请假","left-text":"返回","right-text":"查看记录","left-arrow":"",fixed:""},on:{"click-right":e.onClickRight,"click-left":e.onClickLeft}}),a("div",{staticClass:"top"},[a("van-cell",{attrs:{title:"请假人",border:"",required:""},model:{value:e.person,callback:function(t){e.person=t},expression:"person"}}),a("van-cell",{attrs:{title:"班级",border:"",required:""},model:{value:e.gradeClass,callback:function(t){e.gradeClass=t},expression:"gradeClass"}}),a("van-cell",{attrs:{title:"请假类型","is-link":"",border:"",required:""},on:{click:function(t){e.leaveType=!0}},model:{value:e.sleaveType,callback:function(t){e.sleaveType=t},expression:"sleaveType"}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.leaveType,callback:function(t){e.leaveType=t},expression:"leaveType"}},[a("van-picker",{attrs:{"show-toolbar":"",title:"请假类型",columns:e.leaveTypeList},on:{confirm:e.selectLeaveType,cancel:function(t){e.leaveType=!1}}})],1)],1),a("div",{staticClass:"top"},[a("van-cell",{attrs:{title:"开始时间","is-link":"",border:"",required:""},on:{click:function(t){e.startTime=!0}},model:{value:e.sStartTime,callback:function(t){e.sStartTime=t},expression:"sStartTime"}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}},[a("van-datetime-picker",{attrs:{"show-toolbar":"",type:"datetime","min-date":e.minStartDate},on:{confirm:e.confirmStart,cancel:function(t){e.startTime=!1}}})],1),a("van-cell",{attrs:{title:"结束时间","is-link":"",border:"",required:""},on:{click:function(t){e.endTime=!0}},model:{value:e.sEndTime,callback:function(t){e.sEndTime=t},expression:"sEndTime"}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}},[a("van-datetime-picker",{attrs:{"show-toolbar":"",type:"datetime","min-date":e.minEndDate},on:{confirm:e.confirmEnd,cancel:function(t){e.endTime=!1}}})],1),a("van-field",{attrs:{label:"请假天数","input-align":"right",border:"",required:"",placeholder:"请输入请假天数"},model:{value:e.leaveDay,callback:function(t){e.leaveDay=t},expression:"leaveDay"}})],1),a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[e._v("请假理由")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reason,expression:"reason"}],attrs:{name:"reason",resize:"",placeholder:"请输入请假理由"},domProps:{value:e.reason},on:{input:function(t){t.target.composing||(e.reason=t.target.value)}}})]),a("div",{staticClass:"top"},[a("van-cell",{attrs:{value:"添加图片"}}),a("upload-img",{on:{imgData:e.imgData}})],1),a("div",{staticClass:"btn-group"},[a("van-button",{staticClass:"btn blue",attrs:{round:"",size:"large"},on:{click:e.submit}},[e._v("提交")])],1)],1)},n=[],s=(a("96cf"),a("cb0c")),o=(a("ac6a"),a("f3e2"),a("9395")),r=a("2f62"),l=a("b3d1"),c=a("c583"),u=a("a976"),m={name:"leave",data:function(){return{leaveType:!1,startTime:!1,endTime:!1,sleaveType:"请选择",sStartTime:"请选择",sEndTime:"请选择",minStartDate:new Date,minEndDate:new Date,leaveDay:null,reason:null,leaveTypeData:[],leaveTypeList:[],photoList:[],person:"",gradeClass:"",leaveForm:{schoolId:"",schoolName:"",deptId:"",deptName:"",professionId:"",professionName:"",classId:"",className:"",userName:"",userId:"",startTime:"",endTime:"",leaveDay:"",leaveReason:"",leaveTypeCode:"",leaveTypeText:"",photo:"",isAdditional:"",applyOption:[{userName:"",operator:"提交请假",operatorTime:""}]}}},components:{uploadImg:c["a"],backButton:u["a"]},computed:Object(o["a"])({},Object(r["b"])("system",["userInfo"])),methods:{onClickLeft:function(){this.$router.go(-1)},onClickRight:function(){this.$router.push("leaveHistory")},imgData:function(e){var t=this;e.filePrikeys.forEach(function(e){t.photoList.push(e.filePath)})},selectLeaveType:function(e){var t=this;this.leaveType=!1,this.sleaveType=e,this.leaveTypeData.forEach(function(a){e===a.codeText&&(t.leaveForm.leaveTypeCode=a.code,t.leaveForm.leaveTypeText=a.codeText)})},confirmStart:function(e){this.startTime=!1,this.minEndDate=e,this.sStartTime=this.$moment(e).format("YYYY-MM-DD HH:mm:ss"),this.leaveForm.startTime=this.sStartTime},confirmEnd:function(e){this.endTime=!1,this.sEndTime=this.$moment(e).format("YYYY-MM-DD HH:mm:ss"),this.leaveForm.endTime=this.sEndTime},getUser:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["f"])({userId:this.userInfo.id});case 2:t=e.sent,a=t.data,this.person=this.userInfo.userName,this.leaveForm.applyOption[0].userName=this.userInfo.userName,this.gradeClass=a[0].schoolClassInfo.bJMC,this.leaveForm.schoolId=a[0].schoolInfo.id,this.leaveForm.schoolName=a[0].schoolInfo.xXMC,this.leaveForm.deptId=a[0].sysOrganization.id,this.leaveForm.deptName=a[0].sysOrganization.dWMC,this.leaveForm.professionId=a[0].schoolProfessional.id,this.leaveForm.professionName=a[0].schoolProfessional.zYMC,this.leaveForm.classId=a[0].schoolClassInfo.id,this.leaveForm.className=a[0].schoolClassInfo.bJMC,this.leaveForm.userId=this.userInfo.id,this.leaveForm.userName=this.userInfo.userName;case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getLeaveType:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["e"])();case 2:t=e.sent,a=t.data,this.leaveTypeData=a,this.leaveTypeData.forEach(function(e){i.leaveTypeList.push(e.codeText)}),this.sleaveType=this.leaveTypeData[0].codeText,this.leaveForm.leaveTypeCode=this.leaveTypeData[0].code,this.leaveForm.leaveTypeText=this.leaveTypeData[0].codeText;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getLeave:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["b"])(this.leaveForm);case 2:t=e.sent,t.httpCode,this.$toast.success("提交成功！"),this.$router.go(-1);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),submit:function(){this.leaveForm.leaveDay=this.leaveDay,this.leaveForm.leaveReason=this.reason,this.leaveForm.photo=this.photoList.join(",");var e=new Date;e=this.$moment(e).format("YYYY-MM-DD HH:mm:ss"),this.leaveForm.applyOption[0].operatorTime=e,this.$moment(e).isBefore(this.sStartTime)?this.leaveForm.isAdditional=1:this.leaveForm.isAdditional=0,""!==this.leaveForm.startTime?""!==this.leaveForm.endTime?""!==this.leaveForm.leaveDay?""!==this.leaveForm.leaveReason?this.getLeave():this.$toast("请填写请假原因!"):this.$toast("请填写请假时长!"):this.$toast("请选择结束时间!"):this.$toast("请选择开始时间!")}},mounted:function(){this.getUser(),this.getLeaveType()}},d=m,p=(a("2a20"),a("2877")),v=Object(p["a"])(d,i,n,!1,null,"6d83cb42",null);v.options.__file="leave.vue";t["default"]=v.exports},"3e74":function(e,t,a){},"49f7":function(e,t,a){"use strict";var i=a("3e74"),n=a.n(i);n.a},"6da6":function(e,t,a){},a976:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.back?a("div",{staticClass:"back",on:{click:function(t){e.goBack()}}},[a("van-icon",{attrs:{name:"arrow-left"}}),a("span",[e._v("返回")])],1):e._e()},n=[],s={name:"back-button",data:function(){return{back:!1,appJSObject:window.AppJSObject}},methods:{goBack:function(){this.appJSObject.go_app("back")}},mounted:function(){}},o=s,r=(a("49f7"),a("2877")),l=Object(r["a"])(o,i,n,!1,null,"7bf55662",null);l.options.__file="backButton.vue";t["a"]=l.exports},b3d1:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"c",function(){return s}),a.d(t,"d",function(){return o}),a.d(t,"f",function(){return r}),a.d(t,"e",function(){return l}),a.d(t,"a",function(){return c});var i=a("b775");function n(e){return Object(i["a"])({method:"post",url:"/api/mobileDailyStuLeave",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({method:"put",url:"/api/mobileDailyStuLeave/read/getDetail",data:e})}function o(){return Object(i["a"])({method:"put",url:"/api/mobileDailyStuLeave/read/list",data:{}})}function r(e){return Object(i["a"])({method:"put",url:"/api/userStuStatus/read/findUserPage",data:e})}function l(){return Object(i["a"])({method:"put",url:"/api/mobileDic/read/dic",data:{type:"QJLX"}})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({method:"post",url:"/api/mobileDailyStuLeave/read/updateBaN",data:e})}}}]);
//# sourceMappingURL=leave.f317be66.js.map