{"remainingRequest":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\babel-loader\\lib\\index.js!F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\src\\components\\upload\\uploadImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\src\\components\\upload\\uploadImg.vue","mtime":1543458639907},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1543456662663},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\babel-loader\\lib\\index.js","mtime":1543456662314},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1543456662663},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\vue-loader\\lib\\index.js","mtime":1543456678579}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"F:\\\\\\u9752\\u5CF0\\u8F6F\\u4EF6\\\\\\u901A\\u7528\\u5E73\\u53F0\\\\2018\\u6559\\u52A1\\\\vueProject\\\\school\\\\node_modules\\\\@vue\\\\babel-preset-app\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { uploadFile } from '@/services/api';\nexport default {\n  name: 'upload-img',\n  data: function data() {\n    return {\n      step: 0,\n      imgUrl: '',\n      imgList: []\n    };\n  },\n  methods: {\n    // 上传图片\n    uploaded: function () {\n      var _uploaded = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(img, imgData) {\n        var _this = this;\n\n        var config, formData, data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                config = {\n                  onUploadProgress: function onUploadProgress(progressEvent) {\n                    var complete = progressEvent.loaded / progressEvent.total * 100 || 0;\n                    _this.step = complete;\n                  }\n                };\n                formData = new FormData();\n                formData.append('file', img);\n                _context.next = 5;\n                return uploadFile(formData, config);\n\n              case 5:\n                data = _context.sent;\n\n                if (data && (data.httpCode === 200 || '200')) {\n                  this.imgList.push(imgData);\n                  this.$emit('imgData', data.data);\n                } else {\n                  this.$toast('网络错误，请重新上传！');\n                }\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function uploaded(_x, _x2) {\n        return _uploaded.apply(this, arguments);\n      };\n    }(),\n    readImg: function readImg(files, content) {\n      // 预览图片\n      var img = {};\n      img.src = window.URL.createObjectURL(files.file);\n\n      img.onload = function onload() {\n        window.URL.revokeObjectURL(this.src);\n      };\n\n      img.name = files.file.name;\n      this.uploaded(files.file, img);\n    },\n    deleteImg: function deleteImg(index) {\n      this.imgList.splice(index, 1);\n    }\n  }\n};",{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAmBA,SAAA,UAAA,QAAA,gBAAA;AAEA,eAAA;AACA,QAAA,YADA;AAEA,MAFA,kBAEA;AACA,WAAA;AACA,YAAA,CADA;AAEA,cAAA,EAFA;AAGA,eAAA;AAHA,KAAA;AAKA,GARA;AASA,WAAA;AACA;AACA,YAFA;AAAA;AAAA;AAAA,+CAEA,GAFA,EAEA,OAFA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,sBAHA,GAGA;AACA,oCAAA,0BAAA,aAAA,EAAA;AACA,wBAAA,WAAA,cAAA,MAAA,GAAA,cAAA,KAAA,GAAA,GAAA,IAAA,CAAA;AACA,0BAAA,IAAA,GAAA,QAAA;AACA;AAJA,iBAHA;AASA,wBATA,GASA,IAAA,QAAA,EATA;AAUA,yBAAA,MAAA,CAAA,MAAA,EAAA,GAAA;AAVA;AAAA,uBAWA,WAAA,QAAA,EAAA,MAAA,CAXA;;AAAA;AAWA,oBAXA;;AAYA,oBAAA,SAAA,KAAA,QAAA,KAAA,GAAA,IAAA,KAAA,CAAA,EAAA;AACA,uBAAA,OAAA,CAAA,IAAA,CAAA,OAAA;AACA,uBAAA,KAAA,CAAA,SAAA,EAAA,KAAA,IAAA;AACA,iBAHA,MAGA;AACA,uBAAA,MAAA,CAAA,aAAA;AACA;;AAjBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAmBA,WAnBA,mBAmBA,KAnBA,EAmBA,OAnBA,EAmBA;AACA;AACA,UAAA,MAAA,EAAA;AACA,UAAA,GAAA,GAAA,OAAA,GAAA,CAAA,eAAA,CAAA,MAAA,IAAA,CAAA;;AACA,UAAA,MAAA,GAAA,SAAA,MAAA,GAAA;AACA,eAAA,GAAA,CAAA,eAAA,CAAA,KAAA,GAAA;AACA,OAFA;;AAGA,UAAA,IAAA,GAAA,MAAA,IAAA,CAAA,IAAA;AACA,WAAA,QAAA,CAAA,MAAA,IAAA,EAAA,GAAA;AACA,KA5BA;AA6BA,aA7BA,qBA6BA,KA7BA,EA6BA;AACA,WAAA,OAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA;AA/BA;AATA,CAAA","sourcesContent":["<template>\r\n  <div class=\"upload\">\r\n    <ul>\r\n      <li v-for=\"(img, index) in imgList\" :key=\"index\">\r\n        <img class=\"upimg\" :src=\"img.src\" alt=\"\">\r\n        <van-icon name=\"close\" class=\"close\" @click=\"deleteImg(index)\"/>\r\n        <van-progress :percentage=\"step\" :show-pivot=\"false\" v-if=\"step\"/>\r\n      </li>\r\n      <li>\r\n        <van-uploader :after-read=\"readImg\" multiple>\r\n          <div class=\"pos\">\r\n            <span>+</span>\r\n          </div>\r\n        </van-uploader>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { uploadFile } from '@/services/api';\r\n\r\nexport default {\r\n  name: 'upload-img',\r\n  data() {\r\n    return {\r\n      step: 0,\r\n      imgUrl: '',\r\n      imgList: [],\r\n    };\r\n  },\r\n  methods: {\r\n    // 上传图片\r\n    async uploaded(img, imgData) {\r\n      const config = {\r\n        onUploadProgress: (progressEvent) => {\r\n          const complete = (progressEvent.loaded / progressEvent.total) * 100 || 0;\r\n          this.step = complete;\r\n        },\r\n      };\r\n      const formData = new FormData();\r\n      formData.append('file', img);\r\n      const data = await uploadFile(formData, config);\r\n      if (data && (data.httpCode === 200 || '200')) {\r\n        this.imgList.push(imgData);\r\n        this.$emit('imgData', data.data);\r\n      } else {\r\n        this.$toast('网络错误，请重新上传！');\r\n      }\r\n    },\r\n    readImg(files, content) {\r\n      // 预览图片\r\n      const img = {};\r\n      img.src = window.URL.createObjectURL(files.file);\r\n      img.onload = function onload() {\r\n        window.URL.revokeObjectURL(this.src);\r\n      };\r\n      img.name = files.file.name;\r\n      this.uploaded(files.file, img);\r\n    },\r\n    deleteImg(index) {\r\n      this.imgList.splice(index, 1);\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n  .upload {\r\n    .upimg {\r\n      width: 50px;\r\n      height: 50px;\r\n    }\r\n    .close {\r\n      position: absolute;\r\n      top: -8px;\r\n      right: -8px;\r\n      background: #fff;\r\n      border-radius: 8px;\r\n    }\r\n    ul {\r\n      background-color: #fff;\r\n      overflow: hidden;\r\n      li {\r\n        float: left;\r\n        margin: 15px;\r\n        position: relative;\r\n      }\r\n    }\r\n    .pos{\r\n      width: 50px;\r\n      height: 50px;\r\n      text-align: center;\r\n      span{\r\n        background: #e7e7ea;\r\n        color:#fff;\r\n        padding: 0 12px;\r\n        font-size: 45px;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src\\components\\upload"}]}