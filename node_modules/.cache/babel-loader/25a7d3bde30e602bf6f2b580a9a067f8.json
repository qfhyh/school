{"remainingRequest":"E:\\vue\\school\\node_modules\\babel-loader\\lib\\index.js!E:\\vue\\school\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue\\school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue\\school\\src\\views\\mine\\accountSafe\\accountSafe.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue\\school\\src\\views\\mine\\accountSafe\\accountSafe.vue","mtime":1543995572600},{"path":"E:\\vue\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535070530000},{"path":"E:\\vue\\school\\node_modules\\babel-loader\\lib\\index.js","mtime":1539569622000},{"path":"E:\\vue\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535070530000},{"path":"E:\\vue\\school\\node_modules\\vue-loader\\lib\\index.js","mtime":1539569642000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\vue\\\\school\\\\node_modules\\\\@vue\\\\babel-preset-app\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\nimport _objectSpread from \"E:\\\\vue\\\\school\\\\node_modules\\\\@vue\\\\babel-preset-app\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { setNewPsd as _setNewPsd } from '@/services/mine';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'accountSafe',\n  data: function data() {\n    return {\n      psdError: false,\n      newPassword: '',\n      psdForm: {\n        id: '',\n        loginId: '',\n        oldPassword: '',\n        password: ''\n      }\n    };\n  },\n  computed: _objectSpread({}, mapGetters('system', ['userInfo'])),\n  methods: {\n    onClickLeft: function onClickLeft() {\n      this.$router.go(-1);\n    },\n    diserror: function diserror() {\n      this.psdError = false;\n    },\n    setNewPsd: function () {\n      var _setNewPsd2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.psdForm.loginId = this.userInfo.sysLogin.id;\n                this.psdForm.id = this.userInfo.id;\n                _context.next = 4;\n                return _setNewPsd(this.psdForm);\n\n              case 4:\n                data = _context.sent;\n\n                if (data.httpCode === '200') {\n                  this.$toast('修改成功！');\n                  this.logout();\n                } else if (data.httpCode === '403') {\n                  this.$toast(data.msg);\n                } else {\n                  this.$toast(data.msg);\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function setNewPsd() {\n        return _setNewPsd2.apply(this, arguments);\n      };\n    }(),\n    logout: function logout() {\n      localStorage.clear();\n      this.$store.dispatch('system/setUserInfo', null);\n      this.$store.dispatch('system/setMenu', null);\n      this.$store.dispatch('system/setToken', null);\n      this.$router.push('/');\n    },\n    submit: function submit() {\n      if (this.psdForm.oldPassword === '') {\n        this.$toast('请填写旧密码！');\n        return;\n      }\n\n      if (this.psdForm.password === '') {\n        this.$toast('请填写新密码！');\n        return;\n      }\n\n      if (this.psdForm.password !== this.newPassword) {\n        this.psdError = true;\n        return;\n      }\n\n      this.setNewPsd();\n    }\n  }\n};",{"version":3,"sources":["accountSafe.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA,SAAA,uBAAA,QAAA,iBAAA;AACA,SAAA,UAAA,QAAA,MAAA;AAEA,eAAA;AACA,QAAA,aADA;AAEA,MAFA,kBAEA;AACA,WAAA;AACA,gBAAA,KADA;AAEA,mBAAA,EAFA;AAGA,eAAA;AACA,YAAA,EADA;AAEA,iBAAA,EAFA;AAGA,qBAAA,EAHA;AAIA,kBAAA;AAJA;AAHA,KAAA;AAUA,GAbA;AAcA,8BACA,WAAA,QAAA,EAAA,CAAA,UAAA,CAAA,CADA,CAdA;AAiBA,WAAA;AACA,eADA,yBACA;AACA,WAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA,KAHA;AAIA,YAJA,sBAIA;AACA,WAAA,QAAA,GAAA,KAAA;AACA,KANA;AAOA,aAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA,qBAAA,OAAA,CAAA,OAAA,GAAA,KAAA,QAAA,CAAA,QAAA,CAAA,EAAA;AACA,qBAAA,OAAA,CAAA,EAAA,GAAA,KAAA,QAAA,CAAA,EAAA;AATA;AAAA,uBAUA,WAAA,KAAA,OAAA,CAVA;;AAAA;AAUA,oBAVA;;AAWA,oBAAA,KAAA,QAAA,KAAA,KAAA,EAAA;AACA,uBAAA,MAAA,CAAA,OAAA;AACA,uBAAA,MAAA;AACA,iBAHA,MAGA,IAAA,KAAA,QAAA,KAAA,KAAA,EAAA;AACA,uBAAA,MAAA,CAAA,KAAA,GAAA;AACA,iBAFA,MAEA;AACA,uBAAA,MAAA,CAAA,KAAA,GAAA;AACA;;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAoBA,UApBA,oBAoBA;AACA,mBAAA,KAAA;AACA,WAAA,MAAA,CAAA,QAAA,CAAA,oBAAA,EAAA,IAAA;AACA,WAAA,MAAA,CAAA,QAAA,CAAA,gBAAA,EAAA,IAAA;AACA,WAAA,MAAA,CAAA,QAAA,CAAA,iBAAA,EAAA,IAAA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,GAAA;AACA,KA1BA;AA2BA,UA3BA,oBA2BA;AACA,UAAA,KAAA,OAAA,CAAA,WAAA,KAAA,EAAA,EAAA;AACA,aAAA,MAAA,CAAA,SAAA;AACA;AACA;;AACA,UAAA,KAAA,OAAA,CAAA,QAAA,KAAA,EAAA,EAAA;AACA,aAAA,MAAA,CAAA,SAAA;AACA;AACA;;AACA,UAAA,KAAA,OAAA,CAAA,QAAA,KAAA,KAAA,WAAA,EAAA;AACA,aAAA,QAAA,GAAA,IAAA;AACA;AACA;;AACA,WAAA,SAAA;AACA;AAzCA;AAjBA,CAAA","sourcesContent":["<template>\r\n  <div class=\"accountSafe\">\r\n    <van-nav-bar\r\n      title=\"修改密码\"\r\n      left-text=\"返回\"\r\n      left-arrow\r\n      fixed\r\n      @click-left=\"onClickLeft\"/>\r\n    <div class=\"wrap\">\r\n      <p>你的登陆账号是：{{$store.state.system.userInfo.account}}</p>\r\n      <div class=\"form\">\r\n        <input type=\"text\" v-model=\"psdForm.oldPassword\"\r\n         placeholder=\"请输入旧密码\" required />\r\n        <input type=\"text\" v-model=\"psdForm.password\" @focus=\"diserror\"\r\n         name=\"phone\" placeholder=\"请输入新密码（6-16个字符或数字）\" required />\r\n        <input type=\"text\" v-model=\"newPassword\" placeholder=\"请再次输入新密码\"\r\n         @focus=\"diserror\" required />\r\n        <p class=\"error\" v-if=\"psdError\">两次输入密码不一致，请重新输入！</p>\r\n      </div>\r\n    </div>\r\n    <div class=\"btn-group\">\r\n      <van-button size=\"large\" class=\"btn blue\" @click=\"submit()\">完成</van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { setNewPsd } from '@/services/mine';\r\nimport { mapGetters } from 'vuex';\r\n\r\nexport default {\r\n  name: 'accountSafe',\r\n  data() {\r\n    return {\r\n      psdError: false,\r\n      newPassword: '',\r\n      psdForm: {\r\n        id: '',\r\n        loginId: '',\r\n        oldPassword: '',\r\n        password: '',\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters('system' , ['userInfo']),\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    diserror() {\r\n      this.psdError = false;\r\n    },\r\n    async setNewPsd() {\r\n      this.psdForm.loginId = this.userInfo.sysLogin.id;\r\n      this.psdForm.id = this.userInfo.id;\r\n      const data = await setNewPsd(this.psdForm);\r\n      if (data.httpCode === '200') {\r\n        this.$toast('修改成功！');\r\n        this.logout();\r\n      } else if(data.httpCode === '403'){\r\n        this.$toast(data.msg);\r\n      }else{\r\n        this.$toast(data.msg);\r\n      }\r\n    },\r\n    logout() {\r\n      localStorage.clear();\r\n      this.$store.dispatch('system/setUserInfo', null);\r\n      this.$store.dispatch('system/setMenu', null);\r\n      this.$store.dispatch('system/setToken', null);\r\n      this.$router.push('/');\r\n    },\r\n    submit() {\r\n      if (this.psdForm.oldPassword === '') {\r\n        this.$toast('请填写旧密码！');\r\n        return;\r\n      }\r\n      if (this.psdForm.password === '') {\r\n        this.$toast('请填写新密码！');\r\n        return;\r\n      }\r\n      if (this.psdForm.password !== this.newPassword) {\r\n        this.psdError = true;\r\n        return;\r\n      }\r\n      this.setNewPsd();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.accountSafe {\r\n  padding: 46px 0 40px;\r\n  background-color: #fff;\r\n  .wrap{\r\n    padding: 0px 26px;\r\n    margin-top: 11px;\r\n  }\r\n  .form{\r\n    input{\r\n      border:0;\r\n      border-bottom:1px solid #e1e1e1;\r\n      width:100%;\r\n      padding: 15px 0;\r\n      font-size: 13px;\r\n    }\r\n    .input-box{\r\n      position: relative;\r\n      .hq{\r\n        background: #1890ff;\r\n        color: #fff;\r\n        border-radius: 4px;\r\n        position: absolute;\r\n        right: 0px;\r\n        top: 0;\r\n      }\r\n    }\r\n  }\r\n  p{\r\n    color: #666;\r\n    font-size: 15px;\r\n    margin: 34px 0px 20px;\r\n  }\r\n  .error{\r\n    color: #ff5757;\r\n    font-size: 14px;\r\n    margin: 10px 0px 40px 26px;\r\n  }\r\n  .btn-group{\r\n    padding: 0 38px;\r\n    margin: 40px 0 0;\r\n    .btn{\r\n        font-size: 17px;\r\n        margin: 0 auto 15px;\r\n        border-radius: 30px;\r\n        height: 6.8vh;\r\n        line-height: 6.8vh;\r\n        background-color: #FFFFFF;\r\n        color: #1890ff;\r\n        border: 1px solid #1890FF;\r\n    }\r\n    .blue{\r\n      background-color: #1890ff;\r\n      color: #FFFFFF;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src\\views\\mine\\accountSafe"}]}