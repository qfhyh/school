{"remainingRequest":"E:\\PJH5\\school\\node_modules\\babel-loader\\lib\\index.js!E:\\PJH5\\school\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\PJH5\\school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\PJH5\\school\\src\\views\\application\\exam\\examStu.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\PJH5\\school\\src\\views\\application\\exam\\examStu.vue","mtime":1545379464328},{"path":"E:\\PJH5\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544431688682},{"path":"E:\\PJH5\\school\\node_modules\\babel-loader\\lib\\index.js","mtime":1544431687962},{"path":"E:\\PJH5\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544431688682},{"path":"E:\\PJH5\\school\\node_modules\\vue-loader\\lib\\index.js","mtime":1544431709523}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\PJH5\\\\school\\\\node_modules\\\\@vue\\\\babel-preset-app\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\nimport _objectSpread from \"E:\\\\PJH5\\\\school\\\\node_modules\\\\@vue\\\\babel-preset-app\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/objectSpread\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from 'vuex';\nimport backButton from '@/components/backButton/backButton.vue';\nimport { getCurrentYear as _getCurrentYear, getYearList as _getYearList, queryStuClassInfo as _queryStuClassInfo, queryExamList as _queryExamList, examSturesult as _examSturesult, selectStuTotal as _selectStuTotal } from '@/services/exam';\nexport default {\n  name: 'examStu',\n  data: function data() {\n    return {\n      userName: '',\n      yearId: '',\n      yearName: '',\n      yearList: [],\n      yearNameList: [],\n      showXn: false,\n      showKs: false,\n      examName: '',\n      examId: '',\n      examInfoList: [],\n      examNameList: [],\n      totalScore: [],\n      examResult: [],\n      list: [],\n      taskNameList: [],\n      ksxqList: []\n    };\n  },\n  components: {\n    'back-button': backButton\n  },\n  computed: _objectSpread({}, mapGetters('system', ['userInfo'])),\n  methods: {\n    onClickLeft: function onClickLeft() {\n      this.$router.go(-1);\n    },\n    onXn: function onXn(value) {\n      var _this = this;\n\n      this.showXn = false;\n      this.yearName = value;\n      this.yearList.forEach(function (element) {\n        if (element.name === value) {\n          _this.yearId = element.id;\n\n          _this.queryStuClassInfo();\n        }\n      });\n    },\n    onKs: function onKs(value) {\n      var _this2 = this;\n\n      this.showKs = false;\n      this.examName = value;\n      this.examList.forEach(function (element) {\n        if (element.examName === value) {\n          _this2.examId = element.id;\n\n          _this2.examSturesult();\n        }\n      });\n    },\n    getCurrentYear: function () {\n      var _getCurrentYear2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _getCurrentYear();\n\n              case 2:\n                data = _context.sent;\n                this.yearId = data.data.id;\n                this.yearName = data.data.name;\n                this.queryStuClassInfo();\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function getCurrentYear() {\n        return _getCurrentYear2.apply(this, arguments);\n      };\n    }(),\n    getYearList: function () {\n      var _getYearList2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this3 = this;\n\n        var data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return _getYearList();\n\n              case 2:\n                data = _context2.sent;\n                this.yearList = data.data;\n                this.yearList.forEach(function (element) {\n                  _this3.yearNameList.push(element.name);\n                });\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function getYearList() {\n        return _getYearList2.apply(this, arguments);\n      };\n    }(),\n    queryStuClassInfo: function () {\n      var _queryStuClassInfo2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var stuListId, data;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                stuListId = [];\n                stuListId.push(this.userInfo.id);\n                _context3.next = 4;\n                return _queryStuClassInfo({\n                  schoolYearId: this.yearId,\n                  sysUserId: stuListId\n                });\n\n              case 4:\n                data = _context3.sent;\n\n                if (data.data.schoolPjclassunion != null && data.data.schoolPjclassunion.schoolGrade != null) {\n                  this.queryExamList(data.data.schoolPjclassunion.schoolGrade.id);\n                }\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function queryStuClassInfo() {\n        return _queryStuClassInfo2.apply(this, arguments);\n      };\n    }(),\n    queryExamList: function () {\n      var _queryExamList2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(grade) {\n        var _this4 = this;\n\n        var data;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return _queryExamList({\n                  yearId: this.yearId,\n                  gradeId: grade\n                });\n\n              case 2:\n                data = _context4.sent;\n                this.examList = data.data;\n\n                if (this.examList != null && this.examList.length > 0) {\n                  this.examId = this.examList[0].id;\n                  this.examName = this.examList[0].examName;\n                  this.examSturesult();\n                }\n\n                this.examNameList = [];\n                this.examList.forEach(function (element) {\n                  _this4.examNameList.push(element.examName);\n                });\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function queryExamList(_x) {\n        return _queryExamList2.apply(this, arguments);\n      };\n    }(),\n    examSturesult: function () {\n      var _examSturesult2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee5() {\n        var data, x, size, start, end;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return _examSturesult({\n                  stuId: this.userInfo.id,\n                  taskId: this.examId\n                });\n\n              case 2:\n                data = _context5.sent;\n                this.examResult = data.data;\n\n                if (this.examResult.bjpm) {\n                  this.examResult.bjpm = Math.round(this.examResult.bjpm);\n                }\n\n                if (this.examResult.njpm) {\n                  this.examResult.njpm = Math.round(this.examResult.njpm);\n                }\n\n                if (this.examResult.gkcj) {\n                  this.ksxqList = [];\n                  size = 4;\n\n                  for (x = 0; x < this.examResult.gkcj.length / size; x += 1) {\n                    start = x * size;\n                    end = start + size;\n                    this.ksxqList.push(this.examResult.gkcj.slice(start, end));\n                  }\n                }\n\n              case 7:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      return function examSturesult() {\n        return _examSturesult2.apply(this, arguments);\n      };\n    }(),\n    selectStuTotal: function () {\n      var _selectStuTotal2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee6() {\n        var _this5 = this;\n\n        var _ref, data, i;\n\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return _selectStuTotal({\n                  stuId: this.userInfo.id\n                });\n\n              case 2:\n                _ref = _context6.sent;\n                data = _ref.data;\n                this.stuTotle = data;\n                this.totalScore = [];\n                this.taskNameList = [];\n                i = 1;\n                this.totalScore[0] = {};\n                this.taskNameList.push('');\n                this.stuTotle.forEach(function (element) {\n                  _this5.taskNameList.push(element.examName);\n\n                  _this5.totalScore[i] = {\n                    value: element.score,\n                    taskId: element.taskId,\n                    stuId: element.stuId\n                  };\n                  i += 1;\n                });\n                this.getEchars();\n\n              case 12:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      return function selectStuTotal() {\n        return _selectStuTotal2.apply(this, arguments);\n      };\n    }(),\n    getEchars: function getEchars() {\n      this.userName = this.userInfo.userName; // 基于准备好的dom，初始化echars实例\n\n      var myChart = this.$echarts.init(document.getElementById('main'));\n      window.onresize = myChart.resize; // myChart.on('click', params =>\n      //   this.$router.push({\n      //     name: 'stuExamInfo',\n      //     params: { taskId: params.data.taskId, stuId: params.data.stuId },\n      //   }));\n\n      myChart.setOption({\n        title: {\n          text: '考试成绩总分走向',\n          left: 'center'\n        },\n        calculable: true,\n        dataZoom: [{\n          type: 'slider',\n          xAxisIndex: [0],\n          show: false,\n          start: 0,\n          end: 50,\n          zoomLock: true\n        }, {\n          type: 'inside',\n          xAxisIndex: [0],\n          show: false,\n          start: 0,\n          end: 50,\n          zoomLock: true\n        }],\n        grid: {\n          left: '4%',\n          right: '4%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: false,\n          data: this.taskNameList,\n          axisLabel: {\n            interval: 0\n          },\n          axisTick: {\n            interval: 0,\n            inside: true,\n            alignWithLabel: true,\n            lignWithLabel: true\n          }\n        }],\n        yAxis: [{\n          type: 'value'\n        }],\n        series: [{\n          type: 'line',\n          smooth: true,\n          clickable: true,\n          showSymbol: true,\n          symbol: 'circle',\n          itemStyle: {\n            normal: {\n              color: '#3399FF',\n              areaStyle: {\n                type: 'default'\n              },\n              label: {\n                show: true\n              }\n            }\n          },\n          data: this.totalScore\n        }]\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.getCurrentYear();\n    this.getYearList();\n    this.selectStuTotal();\n  }\n};",{"version":3,"sources":["examStu.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"addressBook\">\r\n    <back-button></back-button>\r\n    <van-nav-bar\r\n      title=\"成绩系统\"\r\n      left-text=\"返回\"\r\n      right-text=\" \"\r\n      left-arrow\r\n      fixed\r\n      @click-left=\"onClickLeft\"/>\r\n      <van-cell-group>\r\n      <van-cell class=\"select\" v-model=\"yearName\"  @click=\"showXn = true;\"\r\n      is-link border input-align=\"center\"/>\r\n        <van-popup v-model=\"showXn\" position=\"bottom\">\r\n          <van-picker show-toolbar :columns=\"yearNameList\" @cancel=\"showXn = false\"\r\n          @confirm=\"onXn\"/>\r\n        </van-popup>\r\n      <van-cell class=\"select\" v-model=\"examName\" @click=\"showKs = true;\" is-link border\r\n      input-align=\"center\"/>\r\n        <van-popup v-model=\"showKs\" position=\"bottom\">\r\n          <van-picker show-toolbar :columns=\"examNameList\" @cancel=\"showKs = false\"\r\n          @confirm=\"onKs\"/>\r\n        </van-popup>\r\n      </van-cell-group>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <van-row  class=\"total\" type=\"flex\" justify=\"center\">\r\n        <van-col style=\"color:#3399FF;border-right:1px solid #B0C4DE\" span=\"8\">\r\n          <p style=\"margin-bottom:15px;\">总分</p><p>{{this.examResult.total}}</p></van-col>\r\n        <van-col style=\"border-right:1px solid #B0C4DE\" span=\"8\">\r\n          <p style=\"margin-bottom:15px;\">班级排名</p><p>{{this.examResult.bjpm}}</p></van-col>\r\n        <van-col span=\"8\"><p style=\"margin-bottom:15px;\">年级排名\r\n          </p><p>{{this.examResult.njpm}}</p></van-col>\r\n      </van-row>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <van-row  class=\"total\" type=\"flex\"\r\n      v-for=\"(row, index) in this.ksxqList\" :key = \"index\">\r\n        <van-col style=\"border-right:1px solid #B0C4DE;\" span=\"6\"\r\n        v-for=\"(cj, index) in row\" :key = \"index\">\r\n          <p style=\"margin-bottom:15px;color:#3399FF;\">{{cj.finalScore}}</p>\r\n          <p>{{cj.examSubjectruleInfo.schoolCourse.kcmc}}</p></van-col>\r\n      </van-row>\r\n      <div style=\"background:#F8F8F8;height:15px;\"></div>\r\n      <div style=\"overflow-x: scroll\">\r\n        <div id=\"main\" style=\"margin-top:10px;margin-bottom:15px;\r\n        height: 300px;font-size: 5px;margin-left:5px;padding: 5px\"></div>\r\n      </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex';\r\nimport backButton from '@/components/backButton/backButton.vue';\r\nimport { getCurrentYear, getYearList, queryStuClassInfo, queryExamList, examSturesult, selectStuTotal } from '@/services/exam';\r\n\r\nexport default {\r\n  name: 'examStu',\r\n  data() {\r\n    return {\r\n      userName: '',\r\n      yearId: '',\r\n      yearName: '',\r\n      yearList: [],\r\n      yearNameList: [],\r\n      showXn: false,\r\n      showKs: false,\r\n      examName: '',\r\n      examId: '',\r\n      examInfoList: [],\r\n      examNameList: [],\r\n      totalScore: [],\r\n      examResult: [],\r\n      list: [],\r\n      taskNameList: [],\r\n      ksxqList: [],\r\n    };\r\n  },\r\n  components: {\r\n    'back-button': backButton,\r\n  },\r\n  computed: {\r\n    ...mapGetters('system', ['userInfo']),\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    onXn(value) {\r\n      this.showXn = false;\r\n      this.yearName = value;\r\n      this.yearList.forEach((element) => {\r\n        if (element.name === value) {\r\n          this.yearId = element.id;\r\n          this.queryStuClassInfo();\r\n        }\r\n      });\r\n    },\r\n    onKs(value) {\r\n      this.showKs = false;\r\n      this.examName = value;\r\n      this.examList.forEach((element) => {\r\n        if (element.examName === value) {\r\n          this.examId = element.id;\r\n          this.examSturesult();\r\n        }\r\n      });\r\n    },\r\n    async getCurrentYear() {\r\n      const data = await getCurrentYear();\r\n      this.yearId = data.data.id;\r\n      this.yearName = data.data.name;\r\n      this.queryStuClassInfo();\r\n    },\r\n    async getYearList() {\r\n      const data = await getYearList();\r\n      this.yearList = data.data;\r\n      this.yearList.forEach((element) => {\r\n        this.yearNameList.push(element.name);\r\n      });\r\n    },\r\n    async queryStuClassInfo() {\r\n      const stuListId = [];\r\n      stuListId.push(this.userInfo.id);\r\n      const data = await queryStuClassInfo({ schoolYearId: this.yearId, sysUserId: stuListId });\r\n      if (data.data.schoolPjclassunion != null &&\r\n      data.data.schoolPjclassunion.schoolGrade != null) {\r\n        this.queryExamList(data.data.schoolPjclassunion.schoolGrade.id);\r\n      }\r\n    },\r\n    async queryExamList(grade) {\r\n      const data = await queryExamList({ yearId: this.yearId, gradeId: grade });\r\n      this.examList = data.data;\r\n      if (this.examList != null && this.examList.length > 0) {\r\n        this.examId = this.examList[0].id;\r\n        this.examName = this.examList[0].examName;\r\n        this.examSturesult();\r\n      }\r\n      this.examNameList = [];\r\n      this.examList.forEach((element) => {\r\n        this.examNameList.push(element.examName);\r\n      });\r\n    },\r\n    async examSturesult() {\r\n      const data = await examSturesult({ stuId: this.userInfo.id, taskId: this.examId });\r\n      this.examResult = data.data;\r\n      if (this.examResult.bjpm) {\r\n        this.examResult.bjpm = Math.round(this.examResult.bjpm);\r\n      }\r\n      if (this.examResult.njpm) {\r\n        this.examResult.njpm = Math.round(this.examResult.njpm);\r\n      }\r\n      if (this.examResult.gkcj) {\r\n        this.ksxqList = [];\r\n        let x;\r\n        const size = 4;\r\n        for (x = 0; x < this.examResult.gkcj.length / size; x += 1) {\r\n          const start = x * size;\r\n          const end = start + size;\r\n          this.ksxqList.push(this.examResult.gkcj.slice(start, end));\r\n        }\r\n      }\r\n    },\r\n    async selectStuTotal() {\r\n      const { data } = await selectStuTotal({ stuId: this.userInfo.id });\r\n      this.stuTotle = data;\r\n      this.totalScore = [];\r\n      this.taskNameList = [];\r\n      let i = 1;\r\n      this.totalScore[0] = {};\r\n      this.taskNameList.push('');\r\n      this.stuTotle.forEach((element) => {\r\n        this.taskNameList.push(element.examName);\r\n        this.totalScore[i] = { value: element.score, taskId: element.taskId, stuId: element.stuId };\r\n        i += 1;\r\n      });\r\n      this.getEchars();\r\n    },\r\n    getEchars() {\r\n      this.userName = this.userInfo.userName;\r\n      // 基于准备好的dom，初始化echars实例\r\n      const myChart = this.$echarts.init(document.getElementById('main'));\r\n      window.onresize = myChart.resize;\r\n      // myChart.on('click', params =>\r\n      //   this.$router.push({\r\n      //     name: 'stuExamInfo',\r\n      //     params: { taskId: params.data.taskId, stuId: params.data.stuId },\r\n      //   }));\r\n      myChart.setOption({\r\n        title: {\r\n          text: '考试成绩总分走向',\r\n          left: 'center',\r\n        },\r\n        calculable: true,\r\n        dataZoom: [\r\n          {\r\n            type: 'slider',\r\n            xAxisIndex: [0],\r\n            show: false,\r\n            start: 0,\r\n            end: 50,\r\n            zoomLock: true,\r\n          },\r\n          {\r\n            type: 'inside',\r\n            xAxisIndex: [0],\r\n            show: false,\r\n            start: 0,\r\n            end: 50,\r\n            zoomLock: true,\r\n          },\r\n        ],\r\n        grid: {\r\n          left: '4%',\r\n          right: '4%',\r\n          containLabel: true,\r\n        },\r\n        xAxis: [{\r\n          type: 'category',\r\n          boundaryGap: false,\r\n          data: this.taskNameList,\r\n          axisLabel: {\r\n            interval: 0,\r\n          },\r\n          axisTick: {\r\n            interval: 0,\r\n            inside: true,\r\n            alignWithLabel: true,\r\n            lignWithLabel: true,\r\n          },\r\n        }],\r\n        yAxis: [\r\n          {\r\n            type: 'value',\r\n          },\r\n        ],\r\n        series: [{\r\n          type: 'line',\r\n          smooth: true,\r\n          clickable: true,\r\n          showSymbol: true,\r\n          symbol: 'circle',\r\n          itemStyle: { normal: { color: '#3399FF', areaStyle: { type: 'default' }, label: { show: true } } },\r\n          data: this.totalScore,\r\n        }],\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getCurrentYear();\r\n    this.getYearList();\r\n    this.selectStuTotal();\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n  .addressBook {\r\n    padding-top: 44px;\r\n  }\r\n  .select {\r\n    width: 70%;\r\n    margin:0 auto;\r\n    color:#3399FF;\r\n    text-align:center;\r\n  }\r\n  .total {\r\n    text-align:center;\r\n    padding:15px 0;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src\\views\\application\\exam"}]}