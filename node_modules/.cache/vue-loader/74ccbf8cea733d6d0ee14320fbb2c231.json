{"remainingRequest":"E:\\PJH5\\school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\PJH5\\school\\src\\views\\application\\exam\\examTea.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\PJH5\\school\\src\\views\\application\\exam\\examTea.vue","mtime":1545464922172},{"path":"E:\\PJH5\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544431688682},{"path":"E:\\PJH5\\school\\node_modules\\babel-loader\\lib\\index.js","mtime":1544431687962},{"path":"E:\\PJH5\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1544431688682},{"path":"E:\\PJH5\\school\\node_modules\\vue-loader\\lib\\index.js","mtime":1544431709523}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapGetters } from 'vuex';\r\nimport backButton from '@/components/backButton/backButton.vue';\r\nimport { getYearList, getTeaCouInfo } from '@/services/exam';\r\n\r\nexport default {\r\n  name: 'examTea',\r\n  data() {\r\n    return {\r\n      yearId: '',\r\n      gradeId: '',\r\n      classId: '',\r\n      pjClassId: '',\r\n      courseId: '',\r\n      taskId: '',\r\n      taskName: '',\r\n      yearName: '',\r\n      yearList: '',\r\n      isActive: 0,\r\n      isActiveNj: 0,\r\n      isActiveBj: 0,\r\n      isActiveRw: 0,\r\n      isActiveKm: 0,\r\n      isBzr: false,\r\n      gradeList: [],\r\n      taskList: [],\r\n      classList: [],\r\n      courseList: [],\r\n      showClassList: [],\r\n      showTaskList: [],\r\n      showCourseList: [],\r\n    };\r\n  },\r\n  components: {\r\n    'back-button': backButton,\r\n  },\r\n  computed: {\r\n    ...mapGetters('system', ['userInfo']),\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    updateXn(item, index) {\r\n      this.isActive = index;\r\n      this.yearId = item.id;\r\n      this.getTeaCouInfo();\r\n    },\r\n    updateNj(item, index) {\r\n      this.isActiveNj = index;\r\n      this.gradeId = item.gradeId;\r\n      this.defaultClassListAndTaskList();\r\n    },\r\n    updateBj(item, index) {\r\n      this.isActiveBj = index;\r\n      this.classId = item.classId;\r\n      this.pjClassId = item.pjClassId;\r\n      this.isBzr = item.isBzr;\r\n      this.defaultCouList();\r\n    },\r\n    updateRw(item, index) {\r\n      this.isActiveRw = index;\r\n      this.taskId = item.examId;\r\n      this.taskName = item.examName;\r\n    },\r\n    updateKm(item, index) {\r\n      this.isActiveKm = index;\r\n      this.courseId = item.courseId;\r\n    },\r\n    // 数组去重\r\n    unique(arr, param) {\r\n      const res = new Map();\r\n      return arr.filter(arr => !res.has(arr[param]) && res.set(arr[param], 1));\r\n    },\r\n    select() {\r\n      this.$router.push({\r\n        name: 'examTeaResult',\r\n        params: {\r\n          taskId: this.taskId,\r\n          classId: this.classId,\r\n          courseId: this.courseId,\r\n          taskName: this.taskName,\r\n        },\r\n      });\r\n    },\r\n    async getYearList() {\r\n      const data = await getYearList();\r\n      this.yearId = data.data[0].id;\r\n      this.yearList = data.data;\r\n      this.getTeaCouInfo();\r\n    },\r\n    async getTeaCouInfo() {\r\n      this.gradeList = [];\r\n      this.classList = [];\r\n      this.taskList = [];\r\n      this.courseList = [];\r\n      this.isBzr = false;\r\n      const data = await getTeaCouInfo({ yearId: this.yearId, teaId: this.userInfo.id });\r\n      this.pjclassList = data.data.pjclassList;\r\n      if (this.pjclassList && this.pjclassList.length > 0) {\r\n        this.pjclassList.forEach((element) => {\r\n          const njList = {};\r\n          const bjList = {};\r\n          njList.gradeId = element.schoolGrade.id;\r\n          njList.gradeName = element.schoolGrade.name;\r\n          bjList.classId = element.schoolClassInfo.id;\r\n          bjList.className = element.schoolClassInfo.bJMC;\r\n          bjList.pjClassId = element.id;\r\n          bjList.gradeId = element.schoolGrade.id;\r\n          if (element.bzrteadherId === this.userInfo.id) {\r\n            bjList.isBzr = true;\r\n          } else {\r\n            bjList.isBzr = false;\r\n          }\r\n          this.gradeList.push(njList);\r\n          this.classList.push(bjList);\r\n        });\r\n        this.gradeList = this.unique(this.gradeList, 'gradeId');\r\n        this.gradeId = this.gradeList[0].gradeId;\r\n        this.classList = this.unique(this.classList, 'classId');\r\n      }\r\n      this.examTaskList = data.data.examTaskList;\r\n      if (this.examTaskList && this.examTaskList.length > 0) {\r\n        this.examTaskList.forEach((element) => {\r\n          const ksList = {};\r\n          ksList.examId = element.id;\r\n          ksList.examName = element.examName;\r\n          ksList.gradeId = element.gradeId;\r\n          this.taskList.push(ksList);\r\n        });\r\n        this.taskList = this.unique(this.taskList, 'examId');\r\n      }\r\n      this.defaultClassListAndTaskList();\r\n      this.cctList = data.data.cctList;\r\n      if (this.cctList && this.cctList.length > 0) {\r\n        this.cctList.forEach((element) => {\r\n          const dkList = {};\r\n          dkList.pjClassId = element.classId;\r\n          dkList.courseId = element.course.id;\r\n          dkList.courseName = element.course.kcmc;\r\n          this.courseList.push(dkList);\r\n        });\r\n      }\r\n      this.defaultCouList();\r\n    },\r\n    defaultClassListAndTaskList() {\r\n      this.showClassList = [];\r\n      this.classList.forEach((element) => {\r\n        if (element.gradeId === this.gradeId) {\r\n          this.showClassList.push(element);\r\n        }\r\n      });\r\n      if (this.showClassList.length > 0) {\r\n        this.classId = this.showClassList[0].classId;\r\n        this.pjClassId = this.showClassList[0].pjClassId;\r\n        this.isBzr = this.showClassList[0].isBzr;\r\n      }\r\n      this.showTaskList = [];\r\n      this.taskList.forEach((element) => {\r\n        if (element.gradeId === this.gradeId) {\r\n          this.showTaskList.push(element);\r\n        }\r\n      });\r\n      if (this.showTaskList.length > 0) {\r\n        this.taskId = this.showTaskList[0].examId;\r\n        this.taskName = this.showTaskList[0].examName;\r\n      }\r\n    },\r\n    defaultCouList() {\r\n      this.showCourseList = [];\r\n      if (this.isBzr) {\r\n        this.showCourseList.push({ pjClassId: this.pjClassId, courseId: '', courseName: '总分' });\r\n      }\r\n      this.courseList.forEach((element) => {\r\n        if (element.pjClassId === this.pjClassId) {\r\n          this.showCourseList.push(element);\r\n        }\r\n      });\r\n      if (this.showCourseList.length > 0) {\r\n        this.courseId = this.showCourseList[0].courseId;\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getYearList();\r\n  },\r\n};\r\n",{"version":3,"sources":["examTea.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"examTea.vue","sourceRoot":"src\\views\\application\\exam","sourcesContent":["<template>\r\n  <div class=\"addressBook\">\r\n    <back-button></back-button>\r\n    <van-nav-bar\r\n      title=\"成绩系统\"\r\n      left-text=\"返回\"\r\n      right-text=\" \"\r\n      left-arrow\r\n      fixed\r\n      @click-left=\"onClickLeft\"/>\r\n    <div>\r\n      <p class=\"title\">学 年</p>\r\n      <div class=\"select\">\r\n        <button  v-for=\"(item,index) in this.yearList\" :key=\"index\" v-if=\"index<6\"\r\n        :class=\"{active:index === isActive}\" @click=\"updateXn(item,index)\">\r\n          {{item.name}}</button>\r\n      </div>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <p class=\"title\">年 级</p>\r\n      <div class=\"select\">\r\n        <button  v-for=\"(item,index) in this.gradeList\" :key=\"index\"\r\n        :class=\"{active:index === isActiveNj}\" @click=\"updateNj(item,index)\">\r\n          {{item.gradeName}}</button>\r\n      </div>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <p class=\"title\">班 级</p>\r\n      <div class=\"select\">\r\n        <button  v-for=\"(item,index) in this.showClassList\" :key=\"index\"\r\n        :class=\"{active:index === isActiveBj}\" @click=\"updateBj(item,index)\">\r\n          {{item.className}}</button>\r\n      </div>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <p class=\"title\">考试名称</p>\r\n      <div class=\"exam\">\r\n        <button  v-for=\"(item,index) in this.showTaskList\" :key=\"index\"\r\n        :class=\"{active:index === isActiveRw}\" @click=\"updateRw(item,index)\">\r\n          {{item.examName}}</button>\r\n      </div>\r\n      <div style=\"background:#F8F8F8;height:7px;\"></div>\r\n      <p class=\"title\">查询科目</p>\r\n      <div class=\"select\">\r\n        <button  v-for=\"(item,index) in this.showCourseList\" :key=\"index\"\r\n        :class=\"{active:index === isActiveKm}\" @click=\"updateKm(item,index)\">\r\n          {{item.courseName}}</button>\r\n      </div>\r\n      <button class=\"submit\" @click=\"select()\">查  询</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex';\r\nimport backButton from '@/components/backButton/backButton.vue';\r\nimport { getYearList, getTeaCouInfo } from '@/services/exam';\r\n\r\nexport default {\r\n  name: 'examTea',\r\n  data() {\r\n    return {\r\n      yearId: '',\r\n      gradeId: '',\r\n      classId: '',\r\n      pjClassId: '',\r\n      courseId: '',\r\n      taskId: '',\r\n      taskName: '',\r\n      yearName: '',\r\n      yearList: '',\r\n      isActive: 0,\r\n      isActiveNj: 0,\r\n      isActiveBj: 0,\r\n      isActiveRw: 0,\r\n      isActiveKm: 0,\r\n      isBzr: false,\r\n      gradeList: [],\r\n      taskList: [],\r\n      classList: [],\r\n      courseList: [],\r\n      showClassList: [],\r\n      showTaskList: [],\r\n      showCourseList: [],\r\n    };\r\n  },\r\n  components: {\r\n    'back-button': backButton,\r\n  },\r\n  computed: {\r\n    ...mapGetters('system', ['userInfo']),\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    updateXn(item, index) {\r\n      this.isActive = index;\r\n      this.yearId = item.id;\r\n      this.getTeaCouInfo();\r\n    },\r\n    updateNj(item, index) {\r\n      this.isActiveNj = index;\r\n      this.gradeId = item.gradeId;\r\n      this.defaultClassListAndTaskList();\r\n    },\r\n    updateBj(item, index) {\r\n      this.isActiveBj = index;\r\n      this.classId = item.classId;\r\n      this.pjClassId = item.pjClassId;\r\n      this.isBzr = item.isBzr;\r\n      this.defaultCouList();\r\n    },\r\n    updateRw(item, index) {\r\n      this.isActiveRw = index;\r\n      this.taskId = item.examId;\r\n      this.taskName = item.examName;\r\n    },\r\n    updateKm(item, index) {\r\n      this.isActiveKm = index;\r\n      this.courseId = item.courseId;\r\n    },\r\n    // 数组去重\r\n    unique(arr, param) {\r\n      const res = new Map();\r\n      return arr.filter(arr => !res.has(arr[param]) && res.set(arr[param], 1));\r\n    },\r\n    select() {\r\n      this.$router.push({\r\n        name: 'examTeaResult',\r\n        params: {\r\n          taskId: this.taskId,\r\n          classId: this.classId,\r\n          courseId: this.courseId,\r\n          taskName: this.taskName,\r\n        },\r\n      });\r\n    },\r\n    async getYearList() {\r\n      const data = await getYearList();\r\n      this.yearId = data.data[0].id;\r\n      this.yearList = data.data;\r\n      this.getTeaCouInfo();\r\n    },\r\n    async getTeaCouInfo() {\r\n      this.gradeList = [];\r\n      this.classList = [];\r\n      this.taskList = [];\r\n      this.courseList = [];\r\n      this.isBzr = false;\r\n      const data = await getTeaCouInfo({ yearId: this.yearId, teaId: this.userInfo.id });\r\n      this.pjclassList = data.data.pjclassList;\r\n      if (this.pjclassList && this.pjclassList.length > 0) {\r\n        this.pjclassList.forEach((element) => {\r\n          const njList = {};\r\n          const bjList = {};\r\n          njList.gradeId = element.schoolGrade.id;\r\n          njList.gradeName = element.schoolGrade.name;\r\n          bjList.classId = element.schoolClassInfo.id;\r\n          bjList.className = element.schoolClassInfo.bJMC;\r\n          bjList.pjClassId = element.id;\r\n          bjList.gradeId = element.schoolGrade.id;\r\n          if (element.bzrteadherId === this.userInfo.id) {\r\n            bjList.isBzr = true;\r\n          } else {\r\n            bjList.isBzr = false;\r\n          }\r\n          this.gradeList.push(njList);\r\n          this.classList.push(bjList);\r\n        });\r\n        this.gradeList = this.unique(this.gradeList, 'gradeId');\r\n        this.gradeId = this.gradeList[0].gradeId;\r\n        this.classList = this.unique(this.classList, 'classId');\r\n      }\r\n      this.examTaskList = data.data.examTaskList;\r\n      if (this.examTaskList && this.examTaskList.length > 0) {\r\n        this.examTaskList.forEach((element) => {\r\n          const ksList = {};\r\n          ksList.examId = element.id;\r\n          ksList.examName = element.examName;\r\n          ksList.gradeId = element.gradeId;\r\n          this.taskList.push(ksList);\r\n        });\r\n        this.taskList = this.unique(this.taskList, 'examId');\r\n      }\r\n      this.defaultClassListAndTaskList();\r\n      this.cctList = data.data.cctList;\r\n      if (this.cctList && this.cctList.length > 0) {\r\n        this.cctList.forEach((element) => {\r\n          const dkList = {};\r\n          dkList.pjClassId = element.classId;\r\n          dkList.courseId = element.course.id;\r\n          dkList.courseName = element.course.kcmc;\r\n          this.courseList.push(dkList);\r\n        });\r\n      }\r\n      this.defaultCouList();\r\n    },\r\n    defaultClassListAndTaskList() {\r\n      this.showClassList = [];\r\n      this.classList.forEach((element) => {\r\n        if (element.gradeId === this.gradeId) {\r\n          this.showClassList.push(element);\r\n        }\r\n      });\r\n      if (this.showClassList.length > 0) {\r\n        this.classId = this.showClassList[0].classId;\r\n        this.pjClassId = this.showClassList[0].pjClassId;\r\n        this.isBzr = this.showClassList[0].isBzr;\r\n      }\r\n      this.showTaskList = [];\r\n      this.taskList.forEach((element) => {\r\n        if (element.gradeId === this.gradeId) {\r\n          this.showTaskList.push(element);\r\n        }\r\n      });\r\n      if (this.showTaskList.length > 0) {\r\n        this.taskId = this.showTaskList[0].examId;\r\n        this.taskName = this.showTaskList[0].examName;\r\n      }\r\n    },\r\n    defaultCouList() {\r\n      this.showCourseList = [];\r\n      if (this.isBzr) {\r\n        this.showCourseList.push({ pjClassId: this.pjClassId, courseId: '', courseName: '总分' });\r\n      }\r\n      this.courseList.forEach((element) => {\r\n        if (element.pjClassId === this.pjClassId) {\r\n          this.showCourseList.push(element);\r\n        }\r\n      });\r\n      if (this.showCourseList.length > 0) {\r\n        this.courseId = this.showCourseList[0].courseId;\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getYearList();\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n  .addressBook {\r\n    padding-top: 44px;\r\n  }\r\n  .title {\r\n    padding: 4%;\r\n  }\r\n  .select {\r\n    padding: 0 2%;\r\n    margin: 0 auto;\r\n    margin-bottom: 2%;\r\n  }\r\n  .select button {\r\n    width: 29.3%;\r\n    border:1px solid#E0E0E0;\r\n    border-radius:0.4em;\r\n    padding: 2% 0;\r\n    margin:0 2%;\r\n    margin-bottom: 1%;\r\n  }\r\n  .exam {\r\n    padding: 0 2%;\r\n    margin: 0 auto;\r\n    margin-bottom: 2%;\r\n  }\r\n  .exam button {\r\n    width: 92%;\r\n    border:1px solid#E0E0E0;\r\n    border-radius:0.4em;\r\n    padding: 2% 0;\r\n    margin:0 2%;\r\n    margin-bottom: 1%;\r\n  }\r\n  .active {\r\n    background: #3399FF;\r\n    color: #eee;\r\n  }\r\n  .submit {\r\n    width: 70%;\r\n    color: #eee;\r\n    background: #3399FF;\r\n    border:1px solid#E0E0E0;\r\n    border-radius:1em;\r\n    padding: 2% 0;\r\n    margin:4% 15%;\r\n    margin-bottom:10%;\r\n  }\r\n</style>\r\n"]}]}