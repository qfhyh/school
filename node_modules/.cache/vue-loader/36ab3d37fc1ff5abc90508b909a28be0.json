{"remainingRequest":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\src\\views\\application\\apartment\\apartmentSafety.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\src\\views\\application\\apartment\\apartmentSafety.vue","mtime":1543224442000},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535070530000},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\babel-loader\\lib\\index.js","mtime":1539569622000},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535070530000},{"path":"F:\\青峰软件\\通用平台\\2018教务\\vueProject\\school\\node_modules\\vue-loader\\lib\\index.js","mtime":1539569642000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getCurrSchoolInfoList, selectGongYuBuild, asynchronousLoadingFloor, getRooms, selectList, getSecurityType, postSecurity } from '@/services/apartment';\r\nimport uploadImg from '@/components/upload/uploadImg.vue';\r\nimport backButton from '@/components/backButton/backButton.vue';\r\n\r\nexport default {\r\n  name: 'apartmentSafety',\r\n  data() {\r\n    return {\r\n      sCampus: '请选择',\r\n      sApartment: '请选择',\r\n      sFloor: '请选择',\r\n      sDorm: '请选择',\r\n      sPerson: '请选择',\r\n      sSecurityType: '请选择',\r\n      sTime: '请选择',\r\n      sVobj: '请选择',\r\n      campus: false,\r\n      apartment: false,\r\n      floor: false,\r\n      dorm: false,\r\n      vobj: false,\r\n      person: false,\r\n      securityType: false,\r\n      objPerson: false,\r\n      time: false,\r\n      minDate: new Date(),\r\n      campusData: [],\r\n      apartmentData: [],\r\n      floorData: [],\r\n      dormData: [],\r\n      vobjData: [{\r\n        objCode: '1',\r\n        objText: '宿舍',\r\n      }, {\r\n        objCode: '2',\r\n        objText: '学生',\r\n      }],\r\n      personData: [],\r\n      securityTypeData: [],\r\n      campusList: [],\r\n      apartmentList: [],\r\n      floorList: [],\r\n      dormList: [],\r\n      personList: [],\r\n      securityTypeList: [],\r\n      vobjList: ['宿舍', '学生'],\r\n      schoolId: '',\r\n      buildingId: '',\r\n      floorId: '',\r\n      roomId: '',\r\n      illegalCode: '',\r\n      securityData: {\r\n        schoolId: '',\r\n        schoolName: '',\r\n        buildId: '',\r\n        buildName: '',\r\n        floolId: '',\r\n        floolName: '',\r\n        roomId: '',\r\n        roomName: '',\r\n        objCode: '',\r\n        objText: '',\r\n        bedCode: '',\r\n        stuId: '',\r\n        stuName: '',\r\n        illegalCode: '',\r\n        illegalText: '',\r\n        checkTime: '',\r\n        photo: '',\r\n        userSexCode: '',\r\n        userSexText: '',\r\n      },\r\n      photoList: [],\r\n    };\r\n  },\r\n  components: {\r\n    uploadImg,\r\n    backButton,\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    confirm(value) {\r\n      this.time = false;\r\n      this.sTime = value.toLocaleString('chinese', { hour12: false });\r\n    },\r\n    async getCampus() {\r\n      const { data } = await getCurrSchoolInfoList();\r\n      this.campusData = data;\r\n      this.campusData.forEach((element) => {\r\n        this.campusList.push(element.xXMC);\r\n      });\r\n    },\r\n    selectCampus(value) {\r\n      this.campus = false;\r\n      this.sCampus = value;\r\n      this.sApartment = '请选择';\r\n      this.sFloor = '请选择';\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.apartmentList = [];\r\n      this.floorList = [];\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.campusData.forEach((element) => {\r\n        if (element.xXMC === value) {\r\n          this.schoolId = element.id;\r\n          this.securityData.schoolId = element.id;\r\n          this.securityData.schoolName = value;\r\n        }\r\n      });\r\n      this.getApartment();\r\n    },\r\n    async getApartment() {\r\n      const { data } = await selectGongYuBuild(this.schoolId);\r\n      this.apartmentData = data;\r\n      this.apartmentData.forEach((element) => {\r\n        this.apartmentList.push(element.mC);\r\n      });\r\n    },\r\n    selectApartment(value) {\r\n      this.apartment = false;\r\n      this.sApartment = value;\r\n      this.sFloor = '请选择';\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.floorList = [];\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.apartmentData.forEach((element) => {\r\n        if (element.mC === value) {\r\n          this.buildingId = element.id;\r\n          this.securityData.buildId = this.buildingId;\r\n          this.securityData.buildName = value;\r\n          this.securityData.userSexCode = element.uses;\r\n          this.securityData.userSexText = element.usesText;\r\n        }\r\n      });\r\n      this.getFloor();\r\n    },\r\n    async getFloor() {\r\n      const { data } = await asynchronousLoadingFloor(this.buildingId);\r\n      this.floorData = data;\r\n      this.floorData.forEach((element) => {\r\n        this.floorList.push(element.name);\r\n      });\r\n    },\r\n    selectFloor(value) {\r\n      this.floor = false;\r\n      this.sFloor = value;\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.floorData.forEach((element) => {\r\n        if (element.name === value) {\r\n          this.floorId = element.id;\r\n          this.securityData.floolId = this.floorId;\r\n          this.securityData.floolName = value;\r\n        }\r\n      });\r\n      this.getDorm();\r\n    },\r\n    async getDorm() {\r\n      const { data } = await getRooms(this.floorId);\r\n      this.dormData = data;\r\n      this.dormData.forEach((element) => {\r\n        this.dormList.push(element.name);\r\n      });\r\n    },\r\n    selectDorm(value) {\r\n      this.dorm = false;\r\n      this.sDorm = value;\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.dormData.forEach((element) => {\r\n        if (element.name === value) {\r\n          this.roomId = element.id;\r\n          this.securityData.roomId = this.roomId;\r\n          this.securityData.roomName = value;\r\n        }\r\n      });\r\n    },\r\n    selectVobj(value) {\r\n      this.vobj = false;\r\n      this.sVobj = value;\r\n      this.sPerson = '请选择';\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.vobjData.forEach((element) => {\r\n        if (element.objText === value) {\r\n          this.securityData.objCode = element.objCode;\r\n          this.securityData.objText = value;\r\n        }\r\n      });\r\n      if (value === '宿舍') {\r\n        this.objPerson = false;\r\n        this.getSecurityType();\r\n      } else if (value === '学生') {\r\n        this.objPerson = true;\r\n        this.getPerson();\r\n      }\r\n    },\r\n    async getPerson() {\r\n      const { data } = await selectList(this.roomId);\r\n      this.personData = data;\r\n      this.personData.forEach((element) => {\r\n        this.personList.push(element.userName);\r\n      });\r\n    },\r\n    selectPerson(value) {\r\n      this.person = false;\r\n      this.sPerson = value;\r\n      this.sSecurityType = '请选择';\r\n      this.securityTypeList = [];\r\n      this.personData.forEach((element) => {\r\n        if (element.userName === value) {\r\n          this.stuId = element.userId;\r\n          this.securityData.bedCode = element.bedCode;\r\n          this.securityData.stuId = this.stuId;\r\n          this.securityData.stuName = value;\r\n        }\r\n      });\r\n      this.getSecurityType();\r\n    },\r\n    async getSecurityType() {\r\n      const { data } = await getSecurityType();\r\n      this.securityTypeData = data;\r\n      this.securityTypeData.forEach((element) => {\r\n        this.securityTypeList.push(element.codeText);\r\n      });\r\n    },\r\n    selectSecurityType(value) {\r\n      this.securityType = false;\r\n      this.sSecurityType = value;\r\n      this.securityTypeData.forEach((element) => {\r\n        if (element.codeText === value) {\r\n          this.illegalCode = element.code;\r\n          this.securityData.illegalCode = this.illegalCode;\r\n          this.securityData.illegalText = value;\r\n        }\r\n      });\r\n    },\r\n    async postSecurity() {\r\n      console.log(this.securityData);\r\n      const data = await postSecurity(this.securityData);\r\n      console.log(data);\r\n      if (data.httpCode === 200 || '200') {\r\n        this.$toast.success('提交成功！');\r\n        this.$router.go(-1);\r\n      } else {\r\n        this.$toast.fail('提交失败！');\r\n      }\r\n    },\r\n    imgData(data) {\r\n      data.filePrikeys.forEach((element) => {\r\n        this.photoList.push(element.filePath);\r\n      });\r\n    },\r\n    submitVisitor() {\r\n      this.securityData.checkTime = this.sTime;\r\n      this.securityData.photo = this.photoList.join(',');\r\n      if (this.securityData.schoolName === '') {\r\n        this.$toast('请选择校区！');\r\n        return;\r\n      }\r\n      if (this.securityData.buildName === '') {\r\n        this.$toast('请选择公寓楼！');\r\n        return;\r\n      }\r\n      if (this.securityData.floolName === '') {\r\n        this.$toast('请选择楼层！');\r\n        return;\r\n      }\r\n      if (this.securityData.roomName === '') {\r\n        this.$toast('请选择宿舍！');\r\n        return;\r\n      }\r\n      if (this.securityData.objText === '') {\r\n        this.$toast('请选择违规对象！');\r\n      } else if (this.securityData.objText === '学生') {\r\n        if (this.securityData.stuName === '') {\r\n          this.$toast('请选择问题人！');\r\n          return;\r\n        }\r\n      }\r\n      if (this.securityData.illegalText === '') {\r\n        this.$toast('请选择隐患类型！');\r\n        return;\r\n      }\r\n      if (this.securityData.checkTime === '') {\r\n        this.$toast('请选择检查时间！');\r\n        return;\r\n      }\r\n      this.postSecurity();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getCampus();\r\n  },\r\n};\r\n",{"version":3,"sources":["apartmentSafety.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"apartmentSafety.vue","sourceRoot":"src\\views\\application\\apartment","sourcesContent":["<template>\r\n  <div class=\"apartmentSafety\">\r\n    <back-button></back-button>\r\n    <van-nav-bar\r\n      title=\"安全检查\"\r\n      left-text=\"返回\"\r\n      right-text=\" \"\r\n      left-arrow\r\n      fixed\r\n      @click-left=\"onClickLeft\"/>\r\n      <div class=\"top\">\r\n        <van-cell-group>\r\n          <van-cell title=\"校区\" @click=\"campus = true;\" is-link border required\r\n           v-model=\"sCampus\"/>\r\n          <van-popup v-model=\"campus\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"校区\" :columns=\"campusList\"\r\n             @confirm=\"selectCampus\" @cancel=\"campus = false;\"/>\r\n          </van-popup>\r\n          <van-cell title=\"公寓\" @click=\"apartment = true;\" is-link border required\r\n           v-model=\"sApartment\" />\r\n          <van-popup v-model=\"apartment\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"公寓\" :columns=\"apartmentList\"\r\n             @confirm=\"selectApartment\" @cancel=\"apartment = false;\"/>\r\n          </van-popup>\r\n          <van-cell title=\"楼层\" @click=\"floor = true;\" is-link border required\r\n           v-model=\"sFloor\" />\r\n          <van-popup v-model=\"floor\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"楼层\" :columns=\"floorList\"\r\n             @confirm=\"selectFloor\" @cancel=\"floor = false;\" />\r\n          </van-popup>\r\n          <van-cell title=\"宿舍\" @click=\"dorm = true;\" is-link border required v-model=\"sDorm\" />\r\n          <van-popup v-model=\"dorm\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"宿舍\" :columns=\"dormList\"\r\n             @confirm=\"selectDorm\" @cancel=\"dorm = false;\" />\r\n          </van-popup>\r\n          <van-cell title=\"违规对象\" @click=\"vobj = true;\" is-link border required v-model=\"sVobj\" />\r\n          <van-popup v-model=\"vobj\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"违规对象\" :columns=\"vobjList\"\r\n             @confirm=\"selectVobj\" @cancel=\"vobj = false;\" />\r\n          </van-popup>\r\n          <van-cell title=\"问题人\" v-if=\"objPerson\" @click=\"person = true;\" is-link\r\n           border required v-model=\"sPerson\" />\r\n          <van-popup v-model=\"person\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"问题人\" :columns=\"personList\"\r\n             @confirm=\"selectPerson\" @cancel=\"person = false;\" />\r\n          </van-popup>\r\n          <van-cell title=\"隐患类型\" @click=\"securityType = true;\" is-link border required\r\n           v-model=\"sSecurityType\" />\r\n          <van-popup v-model=\"securityType\" position=\"bottom\">\r\n            <van-picker show-toolbar title=\"隐患类型\" :columns=\"securityTypeList\"\r\n             @confirm=\"selectSecurityType\" @cancel=\"securityType = false;\" />\r\n          </van-popup>\r\n          <van-cell title=\"检查时间\" @click=\"time = true;\" is-link border required v-model=\"sTime\" />\r\n          <van-popup v-model=\"time\" position=\"bottom\">\r\n            <van-datetime-picker\r\n              show-toolbar\r\n              @confirm=\"confirm\"\r\n              @cancel=\"time = false\"\r\n              type=\"datetime\"\r\n              :min-date=\"minDate\"/>\r\n          </van-popup>\r\n          <van-cell value=\"添加图片\" />\r\n          <upload-img v-on:imgData=\"imgData\"></upload-img>\r\n        </van-cell-group>\r\n      </div>\r\n    <div class=\"btn-group\">\r\n      <van-button round size=\"large\" class=\"btn blue\" @click=\"submitVisitor\">提交</van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getCurrSchoolInfoList, selectGongYuBuild, asynchronousLoadingFloor, getRooms, selectList, getSecurityType, postSecurity } from '@/services/apartment';\r\nimport uploadImg from '@/components/upload/uploadImg.vue';\r\nimport backButton from '@/components/backButton/backButton.vue';\r\n\r\nexport default {\r\n  name: 'apartmentSafety',\r\n  data() {\r\n    return {\r\n      sCampus: '请选择',\r\n      sApartment: '请选择',\r\n      sFloor: '请选择',\r\n      sDorm: '请选择',\r\n      sPerson: '请选择',\r\n      sSecurityType: '请选择',\r\n      sTime: '请选择',\r\n      sVobj: '请选择',\r\n      campus: false,\r\n      apartment: false,\r\n      floor: false,\r\n      dorm: false,\r\n      vobj: false,\r\n      person: false,\r\n      securityType: false,\r\n      objPerson: false,\r\n      time: false,\r\n      minDate: new Date(),\r\n      campusData: [],\r\n      apartmentData: [],\r\n      floorData: [],\r\n      dormData: [],\r\n      vobjData: [{\r\n        objCode: '1',\r\n        objText: '宿舍',\r\n      }, {\r\n        objCode: '2',\r\n        objText: '学生',\r\n      }],\r\n      personData: [],\r\n      securityTypeData: [],\r\n      campusList: [],\r\n      apartmentList: [],\r\n      floorList: [],\r\n      dormList: [],\r\n      personList: [],\r\n      securityTypeList: [],\r\n      vobjList: ['宿舍', '学生'],\r\n      schoolId: '',\r\n      buildingId: '',\r\n      floorId: '',\r\n      roomId: '',\r\n      illegalCode: '',\r\n      securityData: {\r\n        schoolId: '',\r\n        schoolName: '',\r\n        buildId: '',\r\n        buildName: '',\r\n        floolId: '',\r\n        floolName: '',\r\n        roomId: '',\r\n        roomName: '',\r\n        objCode: '',\r\n        objText: '',\r\n        bedCode: '',\r\n        stuId: '',\r\n        stuName: '',\r\n        illegalCode: '',\r\n        illegalText: '',\r\n        checkTime: '',\r\n        photo: '',\r\n        userSexCode: '',\r\n        userSexText: '',\r\n      },\r\n      photoList: [],\r\n    };\r\n  },\r\n  components: {\r\n    uploadImg,\r\n    backButton,\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.go(-1);\r\n    },\r\n    confirm(value) {\r\n      this.time = false;\r\n      this.sTime = value.toLocaleString('chinese', { hour12: false });\r\n    },\r\n    async getCampus() {\r\n      const { data } = await getCurrSchoolInfoList();\r\n      this.campusData = data;\r\n      this.campusData.forEach((element) => {\r\n        this.campusList.push(element.xXMC);\r\n      });\r\n    },\r\n    selectCampus(value) {\r\n      this.campus = false;\r\n      this.sCampus = value;\r\n      this.sApartment = '请选择';\r\n      this.sFloor = '请选择';\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.apartmentList = [];\r\n      this.floorList = [];\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.campusData.forEach((element) => {\r\n        if (element.xXMC === value) {\r\n          this.schoolId = element.id;\r\n          this.securityData.schoolId = element.id;\r\n          this.securityData.schoolName = value;\r\n        }\r\n      });\r\n      this.getApartment();\r\n    },\r\n    async getApartment() {\r\n      const { data } = await selectGongYuBuild(this.schoolId);\r\n      this.apartmentData = data;\r\n      this.apartmentData.forEach((element) => {\r\n        this.apartmentList.push(element.mC);\r\n      });\r\n    },\r\n    selectApartment(value) {\r\n      this.apartment = false;\r\n      this.sApartment = value;\r\n      this.sFloor = '请选择';\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.floorList = [];\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.apartmentData.forEach((element) => {\r\n        if (element.mC === value) {\r\n          this.buildingId = element.id;\r\n          this.securityData.buildId = this.buildingId;\r\n          this.securityData.buildName = value;\r\n          this.securityData.userSexCode = element.uses;\r\n          this.securityData.userSexText = element.usesText;\r\n        }\r\n      });\r\n      this.getFloor();\r\n    },\r\n    async getFloor() {\r\n      const { data } = await asynchronousLoadingFloor(this.buildingId);\r\n      this.floorData = data;\r\n      this.floorData.forEach((element) => {\r\n        this.floorList.push(element.name);\r\n      });\r\n    },\r\n    selectFloor(value) {\r\n      this.floor = false;\r\n      this.sFloor = value;\r\n      this.sDorm = '请选择';\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.dormList = [];\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.floorData.forEach((element) => {\r\n        if (element.name === value) {\r\n          this.floorId = element.id;\r\n          this.securityData.floolId = this.floorId;\r\n          this.securityData.floolName = value;\r\n        }\r\n      });\r\n      this.getDorm();\r\n    },\r\n    async getDorm() {\r\n      const { data } = await getRooms(this.floorId);\r\n      this.dormData = data;\r\n      this.dormData.forEach((element) => {\r\n        this.dormList.push(element.name);\r\n      });\r\n    },\r\n    selectDorm(value) {\r\n      this.dorm = false;\r\n      this.sDorm = value;\r\n      this.sPerson = '请选择';\r\n      this.sSecurityType = '请选择';\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.dormData.forEach((element) => {\r\n        if (element.name === value) {\r\n          this.roomId = element.id;\r\n          this.securityData.roomId = this.roomId;\r\n          this.securityData.roomName = value;\r\n        }\r\n      });\r\n    },\r\n    selectVobj(value) {\r\n      this.vobj = false;\r\n      this.sVobj = value;\r\n      this.sPerson = '请选择';\r\n      this.personList = [];\r\n      this.securityTypeList = [];\r\n      this.vobjData.forEach((element) => {\r\n        if (element.objText === value) {\r\n          this.securityData.objCode = element.objCode;\r\n          this.securityData.objText = value;\r\n        }\r\n      });\r\n      if (value === '宿舍') {\r\n        this.objPerson = false;\r\n        this.getSecurityType();\r\n      } else if (value === '学生') {\r\n        this.objPerson = true;\r\n        this.getPerson();\r\n      }\r\n    },\r\n    async getPerson() {\r\n      const { data } = await selectList(this.roomId);\r\n      this.personData = data;\r\n      this.personData.forEach((element) => {\r\n        this.personList.push(element.userName);\r\n      });\r\n    },\r\n    selectPerson(value) {\r\n      this.person = false;\r\n      this.sPerson = value;\r\n      this.sSecurityType = '请选择';\r\n      this.securityTypeList = [];\r\n      this.personData.forEach((element) => {\r\n        if (element.userName === value) {\r\n          this.stuId = element.userId;\r\n          this.securityData.bedCode = element.bedCode;\r\n          this.securityData.stuId = this.stuId;\r\n          this.securityData.stuName = value;\r\n        }\r\n      });\r\n      this.getSecurityType();\r\n    },\r\n    async getSecurityType() {\r\n      const { data } = await getSecurityType();\r\n      this.securityTypeData = data;\r\n      this.securityTypeData.forEach((element) => {\r\n        this.securityTypeList.push(element.codeText);\r\n      });\r\n    },\r\n    selectSecurityType(value) {\r\n      this.securityType = false;\r\n      this.sSecurityType = value;\r\n      this.securityTypeData.forEach((element) => {\r\n        if (element.codeText === value) {\r\n          this.illegalCode = element.code;\r\n          this.securityData.illegalCode = this.illegalCode;\r\n          this.securityData.illegalText = value;\r\n        }\r\n      });\r\n    },\r\n    async postSecurity() {\r\n      console.log(this.securityData);\r\n      const data = await postSecurity(this.securityData);\r\n      console.log(data);\r\n      if (data.httpCode === 200 || '200') {\r\n        this.$toast.success('提交成功！');\r\n        this.$router.go(-1);\r\n      } else {\r\n        this.$toast.fail('提交失败！');\r\n      }\r\n    },\r\n    imgData(data) {\r\n      data.filePrikeys.forEach((element) => {\r\n        this.photoList.push(element.filePath);\r\n      });\r\n    },\r\n    submitVisitor() {\r\n      this.securityData.checkTime = this.sTime;\r\n      this.securityData.photo = this.photoList.join(',');\r\n      if (this.securityData.schoolName === '') {\r\n        this.$toast('请选择校区！');\r\n        return;\r\n      }\r\n      if (this.securityData.buildName === '') {\r\n        this.$toast('请选择公寓楼！');\r\n        return;\r\n      }\r\n      if (this.securityData.floolName === '') {\r\n        this.$toast('请选择楼层！');\r\n        return;\r\n      }\r\n      if (this.securityData.roomName === '') {\r\n        this.$toast('请选择宿舍！');\r\n        return;\r\n      }\r\n      if (this.securityData.objText === '') {\r\n        this.$toast('请选择违规对象！');\r\n      } else if (this.securityData.objText === '学生') {\r\n        if (this.securityData.stuName === '') {\r\n          this.$toast('请选择问题人！');\r\n          return;\r\n        }\r\n      }\r\n      if (this.securityData.illegalText === '') {\r\n        this.$toast('请选择隐患类型！');\r\n        return;\r\n      }\r\n      if (this.securityData.checkTime === '') {\r\n        this.$toast('请选择检查时间！');\r\n        return;\r\n      }\r\n      this.postSecurity();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getCampus();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.apartmentSafety {\r\n  padding-top: 46px;\r\n}\r\n.btn-group{\r\n  padding: 0 38px;\r\n  margin: 20px 0;\r\n  .btn{\r\n      font-size: 17px;\r\n      margin: 0 auto 15px;\r\n      border-radius: 30px;\r\n      height: 6.8vh;\r\n      line-height: 6.8vh;\r\n      background-color: #FFFFFF;\r\n      color: #1890ff;\r\n      border: 1px solid #1890FF;\r\n  }\r\n  .blue{\r\n      background-color: #1890ff;\r\n      color: #FFFFFF;\r\n  }\r\n}\r\n</style>\r\n"]}]}